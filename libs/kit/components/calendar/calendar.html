<div class="x-calendar-header">
  <button
    x-icon
    variant="subtle"
    (click)="navigatePrevious()"
  >
    <x-icon src="chevron-left" />
  </button>

  <div>
    <span>
      {{ monthName() }}
    </span>
    <span>
      {{ year() }}
    </span>
  </div>

  <button
    x-icon
    variant="subtle"
    (click)="navigateNext()"
  >
    <x-icon src="chevron-right" />
  </button>
</div>

@let $ = slots() | asRecord;

<div class="x-calendar-content">
  @switch (mode()) {
    @case ('days') {
      <div class="x-calendar-days">
        @for (day of dayNames(); track day) {
          <div class="x-calendar-weekday">{{ day }}</div>
        }
      </div>

      <div class="x-calendar-days">
        @for (day of daysInMonth(); track day.getTime()) {
          @let selected = day | map: daySelected: value();
          @let adjacent = day | map: dayAdjacent: month();
          @let disabled = day | map: dayDisabled: min() : max();

          <button
            type="button"
            class="x-calendar-day"
            [class.x-selected]="selected"
            [class.x-adjacent]="adjacent"
            [class.x-disabled]="disabled"
            (click)="selectDay(day)">

            @if ($.day) {
              <ng-container [ngTemplateOutlet]="$.day"
                            [ngTemplateOutletContext]="{ $implicit: { day, selected, adjacent, disabled } }">
              </ng-container>
            } @else {
              {{ day }}
            }
          </button>
        }
      </div>
    }
    @case ('months') {
      <div class="x-calendar-months">
        @for (month of monthsInYear(); track month.getTime()) {
          @let selected = month | map: monthSelected: value();
          @let disabled = month | map: monthDisabled: min() : max();

          <button
            type="button"
            class="month-cell"
            [class.x-selected]="selected"
            [class.x-disabled]="disabled"
            (click)="selectMonth(month)"
          >
            {{ month }}
          </button>
        }
      </div>
    }
    @case ('years') {
      <div class="x-calendar-years">
        @for (year of yearsInDecade(); track year.getTime()) {
          @let selected = year | map: yearSelected: value();
          @let disabled = year | map: yearDisabled: min() : max();

          <button
            type="button"
            class="year-cell"
            [class.x-selected]="selected"
            [class.x-disabled]="disabled"
            (click)="selectYear(year)"
          >
            {{ year }}
          </button>
        }
      </div>
    }
  }
</div>
